{% extends 'home_layout.html' %}
{% load static %}

{% block content %}
<style>
  /* Keyframes for the text fade-in animation */
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .letter {
    opacity: 0;
    animation: fadeIn 2s ease forwards;
  }

  /* Masonry layout for the article grid */
  .masonry {
    column-count: 3;
    column-gap: 1rem; /* Added gap between columns */
  }

  .masonry-item {
    break-inside: avoid;
    page-break-inside: avoid;
    display: block;
    margin-bottom: 1rem;
  }

  /* Responsive adjustments for smaller screens */
  @media screen and (max-width: 1024px) {
    .masonry {
      column-count: 2;
    }
  }

  @media screen and (max-width: 767px) {
    .masonry {
      column-count: 1;
    }
  }
</style>

<!-- Video player with improved responsive width -->
<video autoplay muted loop playsinline class="w-full max-w-4xl mx-auto mt-10">
  <source src="{% static 'lokamom.mp4' %}" type="video/mp4">
  Your browser does not support the video tag.
</video>

<!-- Animated text at the bottom of the page -->
<div class="relative my-5 transform w-full max-w-4xl z-50">
  <div id="animatedText" class="text-[#0f766e] text-center font-bold text-2xl md:text-3xl px-4 max-w-3xl mx-auto">
    <!-- Animated text will be injected here by JavaScript -->
  </div>
</div>

<hr class="w-full bg-[#0f766e]">

<div class="py-10">
  <h1 class="text-5xl my-4 font-semibold text-[#0f766e] font-serif">Get a glimpse of our articles</h1>
</div>

<!-- Article grid with masonry layout -->
<div class="masonry mb-10 max-w-5xl">
  {% for article in article_data %}
  <!-- Article Card: Made fully responsive with better styling -->
  <div class="text-wrap p-4 mb-4 bg-orange-100 flex flex-col justify-between masonry-item">
    <h1 class="font-bold text-xl text-center text-[#0f766e] my-2">{{ article.title }}</h1>

    {% comment %} The image displayed depends on the article's section. Alt text is now populated for accessibility. {% endcomment %}
    {% if article.section == '1' %}
    <img src="{% static 'fives/working_1.png' %}" alt="Image for {{ article.title }}" class="w-full h-auto my-2">
    {% elif article.section == '2' %}
    <img src="{% static 'fives/initial.png' %}" alt="Image for {{ article.title }}" class="w-full h-auto my-2 ">
    {% elif article.section == '3' %}
    <img src="{% static 'fives/pregnant_2.png' %}" alt="Image for {{ article.title }}" class="w-full h-auto my-2 ">
    {% elif article.section == '4' %}
    <img src="{% static 'fives/baby.png' %}" alt="Image for {{ article.title }}" class="w-full h-auto my-2">
    {% elif article.section == '5' %}
    <img src="{% static 'fives/work_again.png' %}" alt="Image for {{ article.title }}" class="w-full h-auto my-2 ">
    {% endif %}

    <p class="text-left mb-0 mt-2">
      {{ article.preview|safe }} <a href="{% url 'read_article' article.id %}" class="text-[#0f766e] font-semibold hover:underline">Read more</a>
    </p>
  </div>
  {% endfor %}
</div>

<script>
  // This script remains the same, it handles the animated text.
  window.addEventListener("DOMContentLoaded", () => {
    const sentence = `As a Mom, at whatever stage you are, you are doing great!`;
    const container = document.getElementById("animatedText");
    // Clear previous content to prevent duplication on hot reloads
    container.innerHTML = ''; 
    [...sentence].forEach((char, index) => {
      const span = document.createElement("span");
      span.textContent = char;
      span.className = "letter";
      // Add a small delay to the animation for each letter
      span.style.animationDelay = `${index * 0.025}s`;
      container.appendChild(span);
    });
  });
</script>
{% endblock content %}
